webpackJsonp([1],{"+BTi":function(e,t){},"0Vzb":function(e,t){},"4hwi":function(e,t){},"5rGo":function(e,t){},"7w/g":function(e,t){},"C/ne":function(e,t){},C15t:function(e,t){},Dzb6:function(e,t){},GXEp:function(e,t){},LL4n:function(e,t){},NHnr:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i("cwe7"),i("+BTi");var s=i("2X9z"),a=i.n(s),n=(i("oq7i"),i("+TD8")),o=i.n(n),r=(i("X+ky"),i("HJMx")),c=i.n(r),l=(i("Yq4J"),i("qubY")),d=i.n(l),p=(i("U/ZW"),i("+nRk")),u=i.n(p),m=(i("LL4n"),i("BrEC")),h=i.n(m),v=(i("Dzb6"),i("o6kb")),f=i.n(v),w=(i("RWjY"),i("aMwW")),g=i.n(w),_=(i("GXEp"),i("mtrD")),C=i.n(_),b=i("7+uW"),x=i("pFYg"),y=i.n(x),k=i("Dd8w"),S=i.n(k),D=i("NYxO"),O=i("mtWM"),$=i.n(O),E=i("hU7x"),T=i.n(E),A="",I="https://preview.wps.com/preview/getShareDocview",M="https://account.wps.com";$.a.defaults.withCredentials=!0;var L=function(e,t,i){return $.a.get(e,t||{}).then(i).catch(function(e){e.response?i(e.response):i({status:500,data:{result:"errInter"}})})},P=function(e,t,i,s){return $.a.post(e,t||{},i||{}).then(s).catch(function(e){e.response?s(e.response):s({status:500,data:{result:"errInter"}})})},R=function(e,t,i,s){return $.a.delete(e,S()({data:t},i)).then(s).catch(function(e){e.response?s(e.response):s({status:500,data:{result:"errInter"}})})},U=function(e,t,i){return T()(e,t,function(e,t){e?i():i(t)})};function W(e,t){var i=e.nid,s=e.id,a=i?A+"/api/sharedocs/"+encodeURIComponent(i)+"/viewinfo":A+"/api/share/shareinfo?link_suffix="+s;return L(a,{},t)}function j(e,t){var i=e.preview_query,s=e.t;return U(I+"?q="+encodeURIComponent(i)+"&t="+s,{},t)}var F={namespaced:!0,state:{error:!1,msg:"",src:"",imgsrc:"",errorTrans:["fileNotExists","downfail","largefile","convertfail","unsupport","unsupporttype","filetimeout","notupload","invitecodeError","permissionDenied","converTimeout"]},mutations:{error:function(e,t){e.error=!0,e.msg=t},doview:function(e,t){var i=t.dotview,s=i.path;"true"!==i.image?e.src=s:e.imgsrc=s}},actions:{view:function(e,t){var i=e.commit,s=(e.state,e.rootState);j(t,function e(a){if(a&&a.data)window.midTime=(new Date).getTime(),i("doview",a.data,a.data);else if(a&&a.sleep&&!s.destory)setTimeout(function(){j(t,e)},1e3*a.sleep);else{var n=a?a.result:"previewFailed";i("error","preview."+n)}})}}},N=i("fZjL"),V=i.n(N);function G(e){var t=document.cookie.match(new RegExp("(^| )"+e+"=([^;]*)(;|$)"));return null!=t?unescape(t[2]):null}var q={img:["jpg","jpeg","png","gif","bmp","psd"],zip:["zip","7z","rar","iso"],code:["php","py","xml","js","less","sass","jade","css"],doc:["wps","wpt","doc","docx","dot","rtf","xml","docm"],xls:["et","ett","xls","xlsx","xlsm","xlsb","xlam","xltx","xltm","xls","xlt","xla","xlw","odc","uxdc","txt","dbf","prn"],csv:["csv"],ppt:["dps","dpt","pptx","ppt","pptm","ppsx","pps","ppsm","potx","pot","potm","wpd"],text:["txt"],pdf:["pdf"]};b.default.use(D.a);var z=new D.a.Store({modules:{preview:F},state:{fver:0,fname:"",ftype:"",toastCount:0,preview_query:"",url:"",avatar:"",download_url:"",link_permission:"deny",is_login:!1,notExist:0,error:"LinkNotExist",errorCode:"404",toastType:"success",toastMsg:"",sharelink_id:"",statusMsg:{},language:null,destory:!1,fileid:0,ext:"",groupid:0,os:"",userid:0,fromuserid:"",parentid:"",size:"",checked:!1,isWO:!0,dialogShow:!1,dialogData:{},extraData:{editable:!0},current:"",downFlag:!1},mutations:{CLOSE:function(e){e.dialogShow=!1},DIALOG_INIT:function(e){e.dialogData={},e.current="",e.extraData={}},SET_EXTRA:function(e,t){e.extraData=S()({},e.extraData,t)},SHOW_DIALOG:function(e,t){var i=t.dialogData,s=t.current;e.current=s,e.dialogData=i,e.dialogShow=!0},CHANGE_WO:function(e,t){e.isWO=t},SAVEMETA:function(e,t){var i,s,a=t.status,n=t.data;if(200==a){var o=n.doc_name,r=n.preview_query,c=n.download_url,l=n.sharelink_id,d=n.fileid,p=n.doc_id,u=n.fromuserid,m=n.from_userid,h=n.groupid,v=n.size,f=n.doc_size,w=n.parentid;if(""===e.url){e.fname=o;var g=o.slice(o.lastIndexOf(".")+1);e.ftype=(i=g,s="unknown",V()(q).forEach(function(e){if(q[e].indexOf(i)>-1)return s=e,!1}),s),e.sharelink_id=l,e.preview_query=r,e.fileid=d||parseInt(p),e.fromuserid=u||m,e.groupid=h,e.parentid=w,e.size=v||f,e.ext=o.slice(o.lastIndexOf(".")+1)}e.url=c,e.download_url=c}else this.state.error=void 0===y()(n.result)?"errInter":n.result,e.notExist++},UPDATE_URL:function(e,t){e.url=t,e.downFlag=!0},UPDATE_FLAG:function(e){e.downFlag=!1},ERROR:function(e,t){e.error=t,e.notExist++},loginInfo:function(e,t){var i=t.status,s=t.data;e.checked=!0,403==i&&"userNotLogin"==s.result?e.is_login=!1:200==i&&s.userid&&(e.is_login=!0,e.avatar=s.pic,e.userid=s.userid)},permisson:function(e,t){var i=t.status,s=t.data;200==i?("permit"==s.link_permission||s.groupid)&&(e.link_permission="permit"):403==i&&"permissionDenied"==s.result&&(e.link_permission="deny")},canceled:function(e,t){var i=t.status;t.data;204!=i&&200!=i||(this.state.error="canceled",this.state.errorCode=200),e.notExist++},destory:function(e){e.destory=!0},getOs:function(e){var t="",i="navigator"in window&&"userAgent"in navigator&&navigator.userAgent.toLowerCase()||"",s="navigator"in window&&"appVersion"in navigator&&navigator.appVersion.toLowerCase()||"";/iphone/i.test(i)||/ipad/i.test(i)||/ipod/i.test(i)?t="ios":/android/i.test(i)?t="android":/win/i.test(s)&&/phone/i.test(i)?t="windowsPhone":/mac/i.test(s)?t="MacOSX":/win/i.test(s)?t="windows":/linux/i.test(s)&&(t="linux"),e.os=t}},actions:{download:function(e,t){var i=e.commit;W(t,function(e){200==e.status&&i("UPDATE_URL",e.data.download_url)})},getMeta:function(e,t){var i=e.commit,s=(e.state,t.id),a=t.nid;if(s)return i("CHANGE_WO",!1),void W(t,function(e){200!=e.status&&_dw.onEvent("share_preview",{type:"failed",result:e.data.result}),i("SAVEMETA",e)});L("/api/sharedocs/"+a+"/collab-url",{},function(e){var s=e.status,n=e.data;200==s?n.collab_url&&a?W(t,function(e){200!=e.status?_dw.onEvent("share_preview",{type:"failed",result:e.data.result}):(e.data.preview_query="",window.midTime=(new Date).getTime(),i("SAVEMETA",e),i("preview/doview",{dotview:{path:n.collab_url}}))}):(i("CHANGE_WO",!1),W(t,function(e){200!=e.status&&_dw.onEvent("share_preview",{type:"failed",result:e.data.result}),i("SAVEMETA",e)})):(_dw.onEvent("share_preview",{type:"failed",result:n.result}),i("ERROR",n.result||"errInter"))})},check:function(e,t){var i=e.commit;!function(e,t){P(M+"/p/auth/check",e,{},t)}(t,function(e){i("loginInfo",e)})},postInfo:function(e,t){e.commit;var i=e.state,s=i.fileid,a=i.groupid,n=i.parentid,o=i.fname,r=i.size,c=i.fromuserid,l=location.pathname,d=l.slice(l.lastIndexOf("/")+1),p=window.$ua,u=p.browser,m=p.OS;!function(e,t){P("/api/v4/createroam",e,{},t)}({fileid:s,groupid:a,parentid:n,name:o,app_type:"wps",operation:"open",current_device_id:navigator.userAgent,current_device_type:"web",current_device_name:m+" "+u,status:"ok",size:r,sid:d,fromuid:c},function(e){})},checckPermission:function(e,t){var i,s,a,n,o=e.commit;s=function(e){o("permisson",e)},a=(i=t).id,n=i.nid,L(n?"/api/sharedocs/"+n+"/permissions/control":A+"/api/sharelinks/"+a+"/permission",{},s)},cancelShare:function(e,t){var i,s,a,n,o,r=e.commit,c=e.dispatch;s=function(e){c("close"),r("canceled",e)},a=(i=t).fileid,n=i.id,o=i.groupid,a?P("/api/v3/groups/"+o+"/files/"+a+"/actions/unshare",null,{},s):R(A+"/api/sharelinks/"+n,null,{},s)},close:function(e){var t=e.commit;e.dispatch;t("CLOSE"),setTimeout(function(){t("DIALOG_INIT")},400)}}}),H=i("mvHQ"),X=i.n(H),B=i("Y81h"),J=i.n(B),Y=i("Xxa5"),Z=i.n(Y),K=i("//Fk"),Q=i.n(K),ee=i("exGp"),te=i.n(ee),ie={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"showloadingbox"},[t("div",{staticClass:"loader"},[t("svg",{staticClass:"circular",attrs:{viewBox:"25 25 50 50"}},[t("circle",{staticClass:"path",attrs:{cx:"50",cy:"50",r:"20",fill:"none","stroke-miterlimit":"10"}})])])])},staticRenderFns:[]};var se=i("VU/8")({name:"Loading"},ie,!1,function(e){i("0Vzb")},null,null).exports;$.a.defaults.withCredentials=!0;var ae=function(e,t){if(e&&t){console.log(e);var i={status:500,data:{result:"errInter"}},s=e.response&&"object"==y()(e.response.data)?e.response:i;"userNotLogin"===s.data.result&&!window.cefQuery&&(location.href="https://account.wps.com?cb="+encodeURIComponent(location.href)),"object"===(void 0===s?"undefined":y()(s))?t(s):t(i)}},ne=($.a,function(e,t,i){return $.a.get(""+e,t||{}).then(i).catch(function(e){ae(e,i)})}),oe=function(e,t,i,s){return $.a.post(""+e,t||{},i||{}).then(s).catch(function(e){ae(e,s)})},re=function(e,t,i,s){return $.a.put(""+e,t||{},i||{}).then(s).catch(function(e){ae(e,s)})},ce=function(e,t,i,s){return $.a.delete(""+e,S()({data:t},i)).then(s).catch(function(e){ae(e,s)})};function le(e,t){return re("/api/v3/groups/"+e.groupid+"/files/"+e.fileid+"/shareinfo",e,{},t)}function de(e,t){return oe("/api/v3/groups/"+e.groupid+"/files/"+e.fileid+"/actions/share",e,{},t)}function pe(e,t){return ne("/api/sharedocs/"+e+"/shareinfo",{},t)}var ue={data:function(){return{shareLoading:!0,copyData:"",error:"",viewMode:"",expire:3,members:[]}},components:{Loading:se},created:function(){if(this.old){var e=this.$route.params.id;this.copyData="https://drive.wps.com/docs/"+e,this.viewMode="anyone-view",this.expire=3,this.shareLoading=!1}else if("permit"==this.link_permission){var t=this.dialogData,i=t.copyData,s=t.viewMode,a=t.expire;i?(this.copyData=i,this.viewMode=s,this.expire=a,"specific-access"==this.viewMode&&this.getContacts(),this.shareLoading=!1):this.doShare()}else if(this.is_login)this.getInfo();else{var n=this.$route.params.nid;this.copyData="https://drive.wps.com/d/"+n,this.shareLoading=!1}},computed:S()({},Object(D.d)(["dialogData","extraData","link_permission","fname","fileid","groupid","is_login"]),{mode:function(){var e={"anyone-view":this.$t("Anyone"),"anyone-edit":this.$t("Anyedit"),"specific-access":this.$t("Someone")};return e[this.viewMode]},expireDate:function(){return[3,7,30,0][this.expire]},expireTxt:function(){return["Thdays","Sedays","Thtdays","Forever"][this.expire]},ext:function(){var e=this.fname;return e.slice(e.lastIndexOf(".")+1)},editable:function(){return[].indexOf(this.ext.toLowerCase())>-1},old:function(){var e=this.$route.params,t=e.id;e.nid;return!!t}}),methods:S()({},Object(D.c)(["SET_EXTRA","SHOW_DIALOG"]),{getInfo:function(){var e=this;return te()(Z.a.mark(function t(){var i,s,a,n,o;return Z.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=e.$route.params.nid,t.next=3,new Q.a(function(e){pe(i,function(t){e(t)})});case 3:s=t.sent,a=s.status,n=s.data,a>=200&&a<300&&(o=[3,7,30,0],e.copyData="https://drive.wps.com/d/"+i,e.expire=o.indexOf(n.validity_term),e.viewMode=n.access_mode,e.shareLoading=!1);case 7:case"end":return t.stop()}},t,e)}))()},doShare:function(){var e=this;return te()(Z.a.mark(function t(){var i,s,a,n;return Z.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=e.fileid,s=e.groupid,t.next=3,new Q.a(function(e){de({fileid:i,groupid:s},function(t){e(t)})});case 3:(a=t.sent).status>=200&&a.status<300?(n=[3,7,30,0],e.copyData=a.data.share_link,e.viewMode=a.data.access_mode,e.expire=n.indexOf(a.data.validity_term),"specific-access"==e.viewMode&&e.getContacts()):e.error=e.$t(a.data.result),e.shareLoading=!1;case 6:case"end":return t.stop()}},t,e)}))()},copySuccess:function(e){this.$message.success(this.$t("Copylink"))},copyError:function(){this.$message.success(this.$t("Copyerror"))},switchTab:function(e,t){var i=this;if(void 0!=e){this[t]=e,le({fileid:this.fileid,groupid:this.groupid,access_mode:this.viewMode,validity_term:this.expireDate},function(e){var t=e.status,s=e.data;t>=200&&t<300?"specific-access"==i.viewMode&&i.getContacts():i.$message.error(i.$t(s.result))})}else{var s=this.dialogData,a=(this.viewMode,this.expire,this.copyData,this.editable),n=this.groupid,o=this.fileid;this.SET_EXTRA({editable:a,dialogData:s}),this.SHOW_DIALOG({current:"Confirm",dialogData:{confirmInfo:this.$t("Stoptip"),header:!0,action:"cancelShare",paload:{groupid:n,fileid:o},size:"small",title:this.$t("Stopshare"),confirmtxt:this.$t("Stopshare"),close:this.back}})}},switchMember:function(e,t){var i,s,a=this,n=this.groupid,o=this.fileid;e?(s=function(i){var s=i.status,n=i.data;if(200==s){var o=a.members.map(function(i){return i.invitee.id===t&&(i.permission=e),i});a.members=o}else a.$message.error(a.$t(n.result))},re("/api/v3/groups/"+(i={groupid:n,fileid:o,invitee:t,permission:e}).groupid+"/files/"+i.fileid+"/invitees/"+i.invitee,i,{},s)):function(e,t){ce("/api/v3/groups/"+e.groupid+"/files/"+e.fileid+"/invitees/"+e.invitee,e,{},t)}({groupid:n,fileid:o,invitee:t},function(e){var i=e.status,s=e.data;if(200==i){var n=a.members.filter(function(e){return e.invitee.id!==t});a.members=n,a.SET_EXTRA({members:n})}else a.$message.error(a.$t(s.result))})},invite:function(){this.SET_EXTRA({editable:this.editable,dialogData:this.dialogData}),this.SHOW_DIALOG({current:"Contact",dialogData:{link:this.copyData,header:!1,size:"large",close:this.back}})},getContacts:function(){var e,t,i=this,s=this.groupid,a=this.fileid;t=function(e){var t=e.status,s=e.data;200==t&&(i.members=s,i.SET_EXTRA({members:s}))},ne("/api/v3/groups/"+(e={groupid:s,fileid:a}).groupid+"/files/"+e.fileid+"/invitees",{},t)},back:function(){var e=this.extraData,t=this.viewMode,i=this.expire,s=this.copyData;this.SHOW_DIALOG({current:"Share",size:"large",dialogData:S()({},e.dialogData,{link:this.copyData,viewMode:t,expire:i,copyData:s,header:!0})})}})},me={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"share-file dialog-wraper"},[e.shareLoading?e._e():i("div",{staticClass:"share-wraper"},[i("div",{staticClass:"file-share-box"},[i("div",{staticClass:"link-body"},[i("div",{class:"share-url select-all nowrap "+(e.error?"link-error":""),attrs:{title:e.copyData}},[e._v(e._s(e.error||e.copyData))]),e._v(" "),i("div",{directives:[{name:"clipboard",rawName:"v-clipboard",value:e.copyData,expression:"copyData"},{name:"t",rawName:"v-t",value:"Copy",expression:"'Copy'"}],staticClass:"copy-link",on:{success:e.copySuccess,error:e.copyError}})])]),e._v(" "),e.is_login?i("div",{staticClass:"share-permission-wraper"},[i("div",{staticClass:"link-permission-box"},["permit"!==e.link_permission||e.old?i("span",{staticClass:"link-permission link-nowrap nowrap"},[e._v(e._s(e.mode))]):e._e(),e._v(" "),"permit"!==e.link_permission||e.old?e._e():i("el-dropdown",{staticClass:"link-nowrap",attrs:{trigger:"click",placement:"bottom-start"},on:{command:function(t){return e.switchTab(t,"viewMode")}}},[i("span",{staticClass:"link-permission"},[i("span",{staticClass:"link-permission-tip nowrap"},[e._v(e._s(e.mode))]),i("i",{staticClass:"components-icons el-icon-caret-bottom"})]),e._v(" "),i("el-dropdown-menu",{staticClass:"list-actions",attrs:{slot:"dropdown","visible-arrow":!1},slot:"dropdown"},[i("el-dropdown-item",{class:["list-action-item","anyone-view"==e.viewMode?"checked":""],attrs:{command:"anyone-view"}},[i("div",{staticClass:"list-action-inner"},[i("div",{staticClass:"list-checked"},[i("i",{staticClass:"components-icons el-icon-check"},[i("span",{staticClass:"path1"})])]),e._v(e._s(e.$t("Anyone")))])]),e._v(" "),e.editable?i("el-dropdown-item",{class:["list-action-item","anyone-edit"==e.viewMode?"checked":""],attrs:{command:"anyone-edit"}},[i("div",{staticClass:"list-action-inner"},[i("div",{staticClass:"list-checked"},[i("i",{staticClass:"components-icons el-icon-check"},[i("span",{staticClass:"path1"})])]),e._v(e._s(e.$t("Anyedit")))])]):e._e(),e._v(" "),e._e(),e._v(" "),i("el-dropdown-item",{staticClass:"list-action-item"},[i("div",{staticClass:"list-action-inner"},[i("span",{staticClass:"stop-share"},[i("div",{staticClass:"list-checked"}),e._v(e._s(e.$t("Stopshare")))])])])],1)],1),e._v(" "),i("span",{staticClass:"link-expire"},[i("span",{staticClass:"link-expire-tip nowrap"},[e._v(e._s(e.$t("Expire")))]),e._v(" "),"permit"!==e.link_permission||e.old?i("span",{staticClass:"link-expire-date"},[e._v(e._s(e.$t(e.expireTxt)))]):e._e(),e._v(" "),"permit"!==e.link_permission||e.old?e._e():i("el-dropdown",{attrs:{trigger:"click",placement:"bottom-end"},on:{command:function(t){return e.switchTab(t,"expire")}}},[i("span",{staticClass:"link-expire-date"},[e._v(e._s(e.$t(e.expireTxt))),i("i",{staticClass:"components-icons el-icon-caret-bottom"},[i("span",{staticClass:"path1"})])]),e._v(" "),i("el-dropdown-menu",{staticClass:"list-actions",attrs:{slot:"dropdown","visible-arrow":!1},slot:"dropdown"},[i("el-dropdown-item",{class:["list-action-item",0==e.expire?"checked":""],attrs:{command:0}},[i("div",{staticClass:"list-action-inner"},[i("div",{staticClass:"list-checked"},[i("i",{staticClass:"components-icons el-icon-check"},[i("span",{staticClass:"path1"})])]),e._v(e._s(e.$t("Thdays")))])]),e._v(" "),i("el-dropdown-item",{class:["list-action-item",1==e.expire?"checked":""],attrs:{command:1}},[i("div",{staticClass:"list-action-inner"},[i("div",{staticClass:"list-checked"},[i("i",{staticClass:"components-icons el-icon-check"},[i("span",{staticClass:"path1"})])]),e._v(e._s(e.$t("Sedays")))])]),e._v(" "),i("el-dropdown-item",{class:["list-action-item",2==e.expire?"checked":""],attrs:{command:2}},[i("div",{staticClass:"list-action-inner"},[i("div",{staticClass:"list-checked"},[i("i",{staticClass:"components-icons el-icon-check"},[i("span",{staticClass:"path1"})])]),e._v(e._s(e.$t("Thtdays")))])]),e._v(" "),i("el-dropdown-item",{class:["list-action-item",3==e.expire?"checked":""],attrs:{command:3}},[i("div",{staticClass:"list-action-inner"},[i("div",{staticClass:"list-checked"},[i("i",{staticClass:"components-icons el-icon-check"},[i("span",{staticClass:"path1"})])]),e._v(e._s(e.$t("Forever")))])])],1)],1)],1)],1),e._v(" "),"specific-access"!=e.viewMode||e.old||"permit"!==e.link_permission?e._e():i("div",{staticClass:"invite-box"},[i("div",{staticClass:"invite-entry"},[i("span",{staticClass:"invite-text",on:{click:e.invite}},[e._m(0),e._v(" "+e._s(e.$t("InivieTip")))]),e._v(" "),i("span",{staticClass:"invited-members"},[e._v("　·　"+e._s(e.members.length)+" "+e._s(e.$t("Joined")))])]),e._v(" "),i("div",{staticClass:"link-members-box"},e._l(e.members,function(t){return i("div",{key:t.key,staticClass:"file-share-member-item"},[i("div",{staticClass:"member-avatar-box"},[i("div",{staticClass:"member-avatar avatar-marginRight"},[i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.invitee.name,placement:"top"}},[i("img",{staticClass:"el-tooltip item",staticStyle:{width:"24px",height:"24px"},attrs:{src:t.invitee.avatar}})])],1)]),e._v(" "),i("div",{staticClass:"member-name-box"},[i("div",{staticClass:"nowrap",staticStyle:{cursor:"default"},attrs:{title:t.invitee.name}},[e._v(e._s(t.invitee.name))])]),e._v(" "),i("div",{staticClass:"member-extension"},[i("el-dropdown",{attrs:{trigger:"click",placement:"bottom-end"},on:{command:function(i){return e.switchMember(i,t.invitee.id)}}},[i("span",{staticClass:"member-permission-select"},[e._v(e._s(e.$t(t.permission))),i("span",{staticClass:"components-icons-box"},[i("i",{staticClass:"components-icons el-icon-caret-bottom"},[i("span",{staticClass:"path1"})])])]),e._v(" "),i("el-dropdown-menu",{staticClass:"list-actions member-permission",attrs:{slot:"dropdown","visible-arrow":!1},slot:"dropdown"},[i("el-dropdown-item",{class:["list-action-item","view"==t.permission?"checked":""],attrs:{command:"view"}},[i("div",{staticClass:"list-action-inner"},[i("div",{staticClass:"list-checked"},[i("i",{staticClass:"components-icons el-icon-check"},[i("span",{staticClass:"path1"})])]),e._v(e._s(e.$t("view")))])]),e._v(" "),e.editable?i("el-dropdown-item",{class:["list-action-item","edit"==t.permission?"checked":""],attrs:{command:"edit"}},[i("div",{staticClass:"list-action-inner"},[i("div",{staticClass:"list-checked"},[i("i",{staticClass:"components-icons el-icon-check"},[i("span",{staticClass:"path1"})])]),e._v(e._s(e.$t("edit")))])]):e._e(),e._v(" "),i("el-dropdown-item",{class:["list-action-item"]},[i("div",{staticClass:"list-action-inner stop-share"},[i("div",{staticClass:"list-checked"},[i("i",{staticClass:"components-icons el-icon-check"},[i("span",{staticClass:"path1"})])]),e._v(e._s(e.$t("Remove")))])])],1)],1)],1)])}))])]):e._e()]),e._v(" "),e.shareLoading?i("div",{staticClass:"share-wraper"},[i("loading")],1):e._e()])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("span",{staticClass:"add-icon"},[t("i",{staticClass:"components-icons el-icon-plus"})])}]};var he=i("VU/8")(ue,me,!1,function(e){i("nLn8")},null,null).exports,ve={data:function(){return{copyData:"",shareLoading:!0,error:"",viewMode:"",expire:3,Onshare:!1,members:[]}},components:{Loading:se},created:function(){this.doShare()},computed:S()({},Object(D.d)(["fname","groupid","ftype","fileid","link_permission","is_login"]),{ext:function(){var e=this.fname;return e.slice(e.lastIndexOf(".")+1)},mode:function(){var e={"anyone-view":this.$t("Anyone"),"anyone-edit":this.$t("Anyedit"),"specific-access":this.$t("Someone")};return e[this.viewMode]},expireDate:function(){return[3,7,30,0][this.expire]},editable:function(){return[].indexOf(this.ext.toLowerCase())>-1}}),methods:S()({},Object(D.b)("index",["share"]),Object(D.c)(["SHOW_DIALOG","DIALOG_INIT"]),Object(D.b)(["close"]),{switchTab:function(e){var t=this;if(e!=this.viewMode)if(e){this.viewMode=e,le({fileid:this.fileid,groupid:this.groupid,access_mode:this.viewMode,validity_term:this.expireDate},function(e){var i=e.status,s=e.data;i>=200&&i<300?(t.viewMode,t.$message.success("Success")):t.$message.error(t.$t(s.result))})}else{this.dialogData,this.viewMode,this.expire,this.copyData,this.dialogIco,this.dialogTitle;var i=this.editable;this.SET_EXTRA({editable:i})}},copySuccess:function(e){this.$message.success(this.$t("Copylink"))},copyError:function(){this.$message.success(this.$t("Copyerror"))},doShare:function(){var e=this;return te()(Z.a.mark(function t(){var i,s,a,n,o,r,c,l,d,p;return Z.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("permit"!=e.link_permission){t.next=8;break}return i=e.fileid,s=e.groupid,t.next=4,new Q.a(function(e){de({fileid:i,groupid:s},function(t){e(t)})});case 4:(a=t.sent).status>=200&&a.status<300?(n=[3,7,30,0],e.expire=n.indexOf(a.data.validity_term),e.copyData=a.data.share_link,e.viewMode=a.data.access_mode):(e.$message.error(e.$t(a.data.result)),e.close()),t.next=20;break;case 8:if(!e.is_login){t.next=18;break}return o=e.$route.params.nid,t.next=12,new Q.a(function(e){pe(o,function(t){e(t)})});case 12:r=t.sent,c=r.status,l=r.data,c>=200&&c<300&&(d=[3,7,30,0],e.copyData="https://drive.wps.com/d/"+o,e.expire=d.indexOf(l.validity_term),e.viewMode=l.access_mode,e.shareLoading=!1),t.next=20;break;case 18:p=e.$route.params.nid,e.copyData="https://drive.wps.com/d/"+p;case 20:e.shareLoading=!1;case 21:case"end":return t.stop()}},t,e)}))()}})},fe={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"share-file"},[e.shareLoading?e._e():i("div",{staticClass:"share-wraper"},[i("div",{staticClass:"mint-header"},[i("div",{staticClass:"mint-header-button is-left",on:{click:e.close}},[e._m(0)]),e._v(" "),i("h1",{staticClass:"mint-header-title"},[e._v(e._s(e.$t("Mycloud")))]),e._v(" "),i("div",{staticClass:"mint-header-button is-right"})]),e._v(" "),i("div",{staticClass:"share-header"},[i("div",{staticClass:"file-item"},[i("div",{staticClass:"item-cell icon"},[i("span",{staticClass:"components-icons-box wps-file-icon"},[i("div",{class:["ftype",e.ftype]})])]),e._v(" "),i("div",{staticClass:"item-cell"},[i("p",{staticClass:"item-cell-name"},[e._v(e._s(e.fname.replace("."+e.ext,"")))])])])]),e._v(" "),i("div",{staticClass:"share-transition"}),e._v(" "),i("div",{staticClass:"share-inner"},["permit"!=e.link_permission&&e.is_login?i("div",{staticClass:"share-per-item"},[i("div",[e._v(e._s(e.$t(e.mode)))])]):e._e(),e._v(" "),"permit"==e.link_permission?i("div",{staticClass:"select-tabs"},[i("div",{staticClass:"share-per-item",on:{click:function(t){e.switchTab("anyone-view")}}},[i("div",[e._v(e._s(e.$t("Anyone"))),"anyone-view"==e.viewMode?i("span",{staticClass:"components-icons-box"},[e._m(1)]):e._e()])]),e._v(" "),e.editable?i("div",{staticClass:"share-per-item",on:{click:function(t){e.switchTab("anyone-edit")}}},[i("div",[e._v(e._s(e.$t("Anyedit"))),"anyone-edit"==e.viewMode?i("span",{staticClass:"components-icons-box"},[e._m(2)]):e._e()])]):e._e()]):e._e(),e._v(" "),i("div",{staticClass:"share-inner-foot"},[i("button",{directives:[{name:"clipboard",rawName:"v-clipboard",value:e.copyData,expression:"copyData"}],staticClass:"mint-button mint-button--primary mint-button--normal",on:{success:e.copySuccess,error:e.copyError}},[i("label",{staticClass:"mint-button-text"},[e._v(e._s(e.$t("Copy")))])])])])]),e._v(" "),e.shareLoading?i("div",{staticClass:"share-wraper"},[i("loading")],1):e._e()])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("p",[t("span",{staticClass:"components-icons-box"},[t("i",{staticClass:"components-icons el-icon-arrow-left"},[t("span",{staticClass:"path1"})])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("i",{staticClass:"components-icons el-icon-check"},[t("span",{staticClass:"path1"})])},function(){var e=this.$createElement,t=this._self._c||e;return t("i",{staticClass:"components-icons el-icon-check"},[t("span",{staticClass:"path1"})])}]};var we=i("VU/8")(ve,fe,!1,function(e){i("infJ")},null,null).exports;var ge={data:function(){return{search:"",selected:[],selectedPeo:[],list:[],permission:"edit",maxPage:!1,currentPage:1,pageCount:10,loading:!1}},created:function(){var e=this;return te()(Z.a.mark(function t(){return Z.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.getContacts();case 1:case"end":return t.stop()}},t,e)}))()},mounted:function(){},computed:S()({},Object(D.d)(["dialogData","extraData","groupid","fileid"]),{disableds:function(){return this.extraData.members?this.extraData.members.map(function(e){return e.invitee.id}):[]}}),methods:S()({},Object(D.c)(["SHOW_DIALOG","SET_EXTRA"]),{getHtml:function(e){var t=this.search.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");return e.replace(new RegExp(t,"ig"),function(e,t){return'<a class="highlight">'+e+"</a>"})},getContacts:function(){var e=this;if(!this.maxPage){var t,i,s,a,n=this.pageCount,o=this.currentPage;i=function(t){var i=t.status,s=t.data;200==i&&(s.length<e.pageCount&&(e.maxPage=!0),e.list=e.list.concat(s))},s=(t={offset:(o-1)*n,limit:n}).offset,a=t.limit,ne("/api/contacts?offset="+s+"&limit="+a,{},i)}},handleScroll:function(){var e=this.$refs.scrollbody,t=e.offsetHeight||e.clientHeight,i=e.scrollTop;e.scrollHeight-(i+t)>=1||0==i||(this.currentPage+=1,this.getContacts())},dosearch:function(){var e,t,i=this;this.search?(e=this.search,t=function(e){var t=e.status,s=e.data;200==t&&(i.list=s)},ne("/api/contacts/search?q="+encodeURIComponent(e),{},t)):(this.currentPage=1,this.maxPage=!1,this.list=[],this.getContacts())},switchPer:function(e){this.permission=e},confirm:function(){var e=this;this.loading=!0;var t,i,s=this.groupid,a=this.fileid;t={groupid:s,fileid:a,invitees:this.selected,permission:this.extraData.editable?this.permission:"view"},i=function(t){var i=t.status;t.data;e.loading=!1,200==i&&(e.dialogData.close(),e.SET_EXTRA({updated:!1}))},oe("/api/v3/groups/"+t.groupid+"/files/"+t.fileid+"/invitees",t,{},i)},doSelected:function(e){var t=this.selected.indexOf(e);if(t>-1)this.selected.splice(t,1),this.selectedPeo.splice(t,1);else{var i=void 0;this.list.map(function(t){return t.userid==e&&(i=t),t}),this.selected.push(e),this.selectedPeo.push(i)}},close:function(){}})},_e={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"contact"},[i("div",{staticClass:"contact-box-wraper"},[i("div",{staticClass:"contact-section left-section"},[i("div",{staticClass:"contact-search"},[i("el-input",{attrs:{placeholder:e.$t("Search"),clearable:""},nativeOn:{keyup:function(t){return e.dosearch(t)}},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}},[i("i",{staticClass:"components-icons el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})])],1),e._v(" "),i("div",{ref:"scrollbody",staticClass:"search-list",on:{scroll:e.handleScroll}},[i("div",{staticClass:"users-list"},e._l(e.list,function(t){return i("div",{key:t.userid,staticClass:"user-item",on:{click:function(i){!(e.disableds.indexOf(t.userid)>-1)&&e.doSelected(t.userid)}}},[i("div",{staticClass:"member-avatar"},[i("img",{staticClass:"el-tooltip item",staticStyle:{width:"24px",height:"24px"},attrs:{src:t.avatar}})]),e._v(" "),i("div",{staticClass:"member-info"},[i("div",{staticClass:"member-name nowrap",attrs:{title:t.nickname},domProps:{innerHTML:e._s(e.search?e.getHtml(t.nickname):t.nickname)}}),e._v(" "),i("div",{staticClass:"member-email nowrap",attrs:{title:t.email},domProps:{innerHTML:e._s(e.search?e.getHtml(t.email):t.email)}})]),e._v(" "),i("div",{class:"member-selection"+(e.disableds.indexOf(t.userid)>-1?" disable":"")},[i("i",{class:e.selected.indexOf(t.userid)>-1||e.disableds.indexOf(t.userid)>-1?"components-icons el-icon-circle-check":"member-unselect"},[i("span",{staticClass:"path1"})])])])}))])]),e._v(" "),i("div",{staticClass:"contact-section right-section"},[i("div",{staticClass:"selected-title"},[e.selected.length?e._e():i("span",{staticClass:"empty-selected"},[e._v(e._s(e.$t("Emptytip")))]),e._v(" "),e.selected.length?i("span",{staticClass:"select-tip nowrap"},[e._v(e._s(e.$t("Selectedusers",{num:e.selected.length})))]):e._e(),e._v(" "),e.selected.length&&!e.extraData.editable?i("span",{staticClass:"member-permission-select"},[e._v(e._s(e.$t("view")))]):e._e(),e._v(" "),e.selected.length&&e.extraData.editable?i("el-dropdown",{attrs:{trigger:"click",placement:"bottom-end"},on:{command:e.switchPer}},[i("span",{staticClass:"member-permission-select"},[e._v(e._s(e.$t(e.permission))),i("span",{staticClass:"components-icons-box"},[i("i",{staticClass:"components-icons el-icon-caret-bottom"},[i("span",{staticClass:"path1"})])])]),e._v(" "),i("el-dropdown-menu",{staticClass:"list-actions member-permission",attrs:{slot:"dropdown","visible-arrow":!1},slot:"dropdown"},[i("el-dropdown-item",{class:["list-action-item","edit"==e.permission?"checked":""],attrs:{command:"edit"}},[i("div",{staticClass:"list-action-inner"},[i("div",{staticClass:"list-checked"},[i("i",{staticClass:"components-icons el-icon-check"},[i("span",{staticClass:"path1"})])]),e._v(e._s(e.$t("edit")))])]),e._v(" "),i("el-dropdown-item",{class:["list-action-item","view"==e.permission?"checked":""],attrs:{command:"view"}},[i("div",{staticClass:"list-action-inner"},[i("div",{staticClass:"list-checked"},[i("i",{staticClass:"components-icons el-icon-check"},[i("span",{staticClass:"path1"})])]),e._v(e._s(e.$t("view")))])])],1)],1):e._e()],1),e._v(" "),i("div",{staticClass:"selected-members"},e._l(e.selectedPeo,function(t){return i("div",{key:t.userid,staticClass:"selected-item"},[i("div",{staticClass:"member-avatar"},[i("img",{staticClass:"el-tooltip item",staticStyle:{width:"24px",height:"24px"},attrs:{src:t.avatar}})]),e._v(" "),i("div",{staticClass:"member-info"},[i("div",{staticClass:"member-name nowrap",attrs:{title:t.nickname}},[e._v(e._s(t.nickname))])]),e._v(" "),i("div",{staticClass:"member-selection",on:{click:function(i){e.doSelected(t.userid)}}},[i("i",{staticClass:"components-icons el-icon-close"})])])})),e._v(" "),i("div",{staticClass:"contact-buttons"},[i("el-button",{on:{click:e.dialogData.close}},[e._v(e._s(e.$t("Cancel")))]),e._v(" "),i("el-button",{attrs:{type:"primary",loading:e.loading,disabled:!e.selected.length,plain:""},on:{click:e.confirm}},[e._v(e._s(e.$t("header.confirm")))])],1)])])])},staticRenderFns:[]};var Ce=i("VU/8")(ge,_e,!1,function(e){i("C/ne")},null,null).exports,be={computed:S()({},Object(D.d)(["dialogData"])),methods:S()({},Object(D.b)(["close"]),{doclose:function(){this.dialogData.close?this.dialogData.close():this.close()},confirm:function(){var e=this.dialogData,t=e.action,i=e.smodule,s=e.mutation,a=e.paload;t?i?this.$store.dispatch(i+"/"+t,a):this.$store.dispatch(t,a):i?this.$store.commit(i+"/"+s):this.$store.commit(s)}})},xe={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"dialog-wraper confirm-dialog-wraper"},[i("p",[i("span",[e._v(e._s(e.dialogData.confirmInfo)),e.dialogData.filename?i("b",[e._v("「"+e._s(e.dialogData.filename)+"」")]):e._e()])]),e._v(" "),i("div",{staticClass:"dialog-foot"},[e.dialogData.nocancel?e._e():i("el-button",{attrs:{size:"mini"},on:{click:e.doclose}},[e._v(e._s(e.$t("Cancel")))]),i("el-button",{attrs:{type:e.dialogData.safe?"primary":"danger",size:"mini"},on:{click:e.confirm}},[e._v(e._s(e.dialogData.confirmtxt||e.$t("Confirm")))])],1)])},staticRenderFns:[]};var ye={data:function(){return{}},components:{Share:he,Mshare:we,Contact:Ce,Confirm:i("VU/8")(be,xe,!1,function(e){i("PXIr")},null,null).exports},computed:S()({},Object(D.d)(["dialogShow","dialogData","current","ftype"])),methods:S()({},Object(D.b)(["close"]))},ke={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{class:[e.dialogData.size,e.dialogData.header?"with-header":""],attrs:{visible:e.dialogShow,width:"30%","close-on-click-modal":!1},on:{close:e.close}},[e.dialogData.header?i("div",{staticClass:"el-dialog__header nowrap",attrs:{slot:"title"},slot:"title"},[e.dialogData.ext?i("div",{class:["ftype",e.ftype]}):e._e(),e._v(" "),i("span",{staticClass:"el-header-title nowrap",attrs:{title:e.dialogData.title}},[e._v(e._s(e.dialogData.title))])]):e._e(),e._v(" "),i(e.current,{tag:"component"})],1)},staticRenderFns:[]};var Se={name:"App",data:function(){return{frameUrl:""}},created:function(){if(J.a.configure({showSpinner:!1}),J.a.start(),this.getOs(),!G("csrf")){for(var e="",t="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",i=t.length,s=0;s<32;s++)e+=t.charAt(Math.floor(Math.random()*i));!function(e,t,i){var s=i.expires,a=i.path,n=i.domain,o=i.secure,r=new Date;r.setTime(r.getTime()),s&&(s=1e3*s*60*60*24);var c=new Date(r.getTime()+s);document.cookie=e+"="+escape(t)+(s?";expires="+c.toGMTString():"")+(a?";path="+a:"")+(n?";domain="+n:"")+(o?";secure":"")}("csrf",e,{domain:".wps.com",path:"/"})}this.check({cached:!0,csrfmiddlewaretoken:G("csrf")}),window.$ua=this.parseUa()},components:{WpsDialog:i("VU/8")(ye,ke,!1,function(e){i("np2T")},null,null).exports},mounted:function(){var e=this;window.addEventListener("message",function(t){var i=("string"==typeof t.data?JSON.parse(t.data):t.data).eventName;if("share"==i){var s=e.groupid,a=e.fname,n=e.fileid,o=a.slice(a.lastIndexOf(".")+1),r=a.slice(0,a.lastIndexOf("."));window.innerWidth<481?e.SHOW_DIALOG({current:"mshare",dialogData:{fileid:n,groupid:s,ext:o,title:r,size:"auto"}}):e.SHOW_DIALOG({current:"share",dialogData:{fileid:n,groupid:s,ext:o,title:r,size:"large",header:!0}})}else if("ready"==i){var c=e;document.getElementById("preview").contentWindow.postMessage(X()({eventName:"setConfig",data:{headers:{shareBtn:{tooltip:c.$t("Share"),callback:"share"},otherMenuBtn:{tooltip:c.$t("More"),items:[{type:3,text:e.$t("preview.download"),callback:"download_file"}]}}}}),"*")}else if("back"==i)location.href="https://drive.wps.com";else if("download_file"==i){var l=e.$route.params,d=l.nid,p=l.id;e.download({id:p,nid:d})}else if("web_login"==i)location.href="https://account.wps.com?cb="+encodeURIComponent(location.href);else if("web_loaded"==i){var u=(new Date).getTime(),m=u-window.startTime,h=u-window.midTime;_dw.onEvent("share_preview",{type:"success",engine:"weboffice",filetype:e.ext,loadtime:m,thtime:h})}})},computed:S()({},Object(D.d)(["toastCount","notExist","toastMsg","toastType","os","url","avatar","fileid","groupid","fname","checked","link_permission","preview_query","is_login","userid","isWO","downFlag","sharelink_id"]),Object(D.d)("preview",["src","imgsrc"]),{canGetPermission:function(){return(this.preview_query||this.src||this.imgsrc)&&this.is_login},canget:function(){return this.avatar&&this.fileid&&this.checked&&"deny"==this.link_permission}}),methods:S()({},Object(D.b)(["check","postInfo","checckPermission","getMeta","download"]),Object(D.c)(["getOs","SHOW_DIALOG","UPDATE_FLAG"]),{parseUa:function(){var e={init:function(){this.browser=this.searchString(this.dataBrowser)||"An unknown browser",this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version",this.OS=this.searchString(this.dataOS)||"an unknown OS"},searchString:function(e){for(var t=0;t<e.length;t++){var i=e[t].string,s=e[t].prop;if(this.versionSearchString=e[t].versionSearch||e[t].identity,i){if(-1!=i.indexOf(e[t].subString))return e[t].identity}else if(s)return e[t].identity}},searchVersion:function(e){var t=e.indexOf(this.versionSearchString);if(-1!=t)return parseFloat(e.substring(t+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera",versionSearch:"Version"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac OS X"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]};return e.init(),e}}),watch:{canget:function(e){e&&this.postInfo()},url:function(e,t){t&&this.downFlag&&(console.log(e),this.frameUrl=e,this.UPDATE_FLAG())},canGetPermission:function(e){var t=this.$route.params.nid;e&&this.checckPermission({id:this.sharelink_id,nid:t})},toastCount:function(){this.$message.closeAll(),this.$message[this.toastType]({duration:3e3,message:this.$t(this.toastMsg),customClass:"request-toast",center:!0})},notExist:function(e){this.$router.replace("/404")},checked:function(e){e&&(_dw.setAppKey("da375dedfadf11fb").setDebug(!1).setAccountId(String(this.userid)).setChannel("wps_oversea_cloud").setVersion("web_share_2.0"),_dw.onEvent("drive_pageview_loadtime",{load_time:(new Date).getTime()-window.startTime,type:"share"}))}}},De={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{"data-platform":e.os+"_webshare"}},[i("keep-alive",[e.$route.meta.keepAlive?i("router-view"):e._e()],1),e._v(" "),e.$route.meta.keepAlive?e._e():i("router-view"),e._v(" "),i("wps-dialog"),e._v(" "),e.isWO?i("iframe",{staticClass:"download_frame",attrs:{src:e.frameUrl,frameborder:"0"}}):e._e()],1)},staticRenderFns:[]};var Oe=i("VU/8")(Se,De,!1,function(e){i("tk6P")},null,null).exports,$e=i("/ocq"),Ee={data:function(){return{frameUrl:"",id:this.$route.params.id,click:0,flag:!1}},created:function(){this.$route.params.nid},computed:S()({},Object(D.d)(["fver","fname","ftype","url","is_login","avatar","fileid","groupid","link_permission","sharelink_id","preview_query","os","downFlag"]),{loginUrl:function(){return"https://account.wps.com?cb="+encodeURIComponent(location.href)},canGetPermission:function(){return(this.preview_query||this.src||this.imgsrc)&&this.is_login},fext:function(){return this.fname.slice(this.fname.lastIndexOf(".")-4)},fprev:function(){return this.fname.slice(0,this.fname.lastIndexOf(".")-4)}}),methods:S()({down:function(){var e=this.$route.params,t=e.id,i=e.nid;this.flag=!0,this.download({nid:i,id:t})},cancelView:function(){var e=this;this.$confirm(this.$t("header.cancelView"),this.$t("header.info"),{confirmButtonText:this.$t("header.confirm"),cancelButtonText:this.$t("header.cancel"),type:"warning"}).then(function(){e.cancelShare({id:e.sharelink_id,fileid:e.fileid,groupid:e.groupid})}).catch(function(){})},count:function(){this.click++}},Object(D.c)(["UPDATE_FLAG"]),Object(D.b)(["getMeta","cancelShare","download"]),{toLogin:function(){var e=this;_dw.onEvent("share_preview_login"),setTimeout(function(){location.href=e.loginUrl},400)}}),watch:{url:function(e,t){e.indexOf("kingsoftofficeapp")>-1?window.location.href=e:t&&(this.flag||this.downFlag)&&(this.frameUrl=e,this.flag=!1,this.UPDATE_FLAG())},fname:function(e){document.title="WPS - "+e},click:function(e){e%6==0&&(alert(navigator.userAgent),alert(this.os))}}},Te={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"header"},[i("div",{staticClass:"fileinfo"},[i("div",{staticClass:"namebox"},[i("p",{staticClass:"filename nowrap",attrs:{title:e.fname},domProps:{textContent:e._s(e.fname)},on:{click:e.count}})]),e._v(" "),i("div",{staticClass:"actions"},[e.is_login?i("div",{staticClass:"avatarbox"},[i("img",{staticClass:"avatar",attrs:{src:e.avatar,alt:""}})]):e._e(),e._v(" "),e.is_login?e._e():i("span",{directives:[{name:"t",rawName:"v-t",value:"header.login",expression:"'header.login'"}],staticClass:"loginbtn",on:{click:e.toLogin}}),e._v(" "),"ios"!==this.os||"permit"===e.link_permission?i("el-dropdown",{attrs:{content:"More",placement:"bottom",effect:"light",trigger:"click","visible-arrow":!1}},[i("span",{staticClass:"ac-item more"}),e._v(" "),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},["ios"!==this.os?i("el-dropdown-item",{staticClass:"nowrap"},[i("span",{on:{click:e.down}},[i("i",{staticClass:"action-icon el-icon-download"}),i("span",{directives:[{name:"t",rawName:"v-t",value:"header.download",expression:"'header.download'"}],staticClass:"GA_download"})])]):e._e(),e._v(" "),i("div",{staticClass:"nowrap",on:{click:e.cancelView}},["permit"===e.link_permission?i("el-dropdown-item",[i("span",[i("i",{staticClass:"action-icon el-icon-circle-close-outline"}),i("span",{directives:[{name:"t",rawName:"v-t",value:"header.cancelShare",expression:"'header.cancelShare'"}],staticClass:"GA_cancelShare"})])]):e._e()],1)],1)],1):e._e()],1),e._v(" "),e.frameUrl?i("iframe",{ref:"frame",staticClass:"func-frame",attrs:{src:e.frameUrl,frameborder:"0"}}):e._e()])])},staticRenderFns:[]};var Ae=i("VU/8")(Ee,Te,!1,function(e){i("5rGo")},"data-v-58d2a6bd",null).exports,Ie={computed:S()({},Object(D.d)(["preview_query","ext","isWO"]),Object(D.d)("preview",["error","msg","src","imgsrc"])),created:function(){var e=this.preview_query;e&&this.view({preview_query:e,t:(new Date).getTime()})},methods:S()({},Object(D.b)("preview",["view"]),Object(D.b)(["getMeta"]),{iframeLoad:function(){if(J.a.done(),!this.isWO){var e=(new Date).getTime(),t=e-window.startTime,i=e-window.midTime;_dw.onEvent("share_preview",{type:"success",engine:"wowserver",filetype:this.ext,loadtime:t,thtime:i})}}}),watch:{preview_query:function(e){this.view({preview_query:e,t:(new Date).getTime()})},error:function(e){e&&J.a.done()}}},Me={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"frame-box"},[e.error?i("div",{staticClass:"process-box"},[i("div",{staticClass:"status-text"},[i("span",{},[e._v(e._s(e.$m(e.msg,"preview.previewFailed")))])])]):e._e(),e._v(" "),e.imgsrc?i("div",{staticClass:"imgbox"},[i("img",{staticClass:"viewimg",attrs:{src:e.imgsrc,alt:""},on:{load:e.iframeLoad}})]):e._e(),e._v(" "),e.src?i("iframe",{staticClass:"view-frame",attrs:{id:"preview",src:e.src,frameborder:"0"},on:{load:e.iframeLoad}}):e._e()])},staticRenderFns:[]};var Le={components:{Vheader:Ae,Preview:i("VU/8")(Ie,Me,!1,function(e){i("7w/g")},"data-v-1fa718ea",null).exports},data:function(){return{id:0,adshow:!0,timer:null}},created:function(){var e=this.$route.params,t=e.id,i=e.nid;this.id=i||t,!this.preview_query&&this.getMeta({id:t,nid:i})},mounted:function(){var e=this,t=this.$refs.open;t&&t.addEventListener("click",function(){_dw.onEvent("share_preview_open"),"android"===e.os&&(window.location="kingsoftofficeapp://qing?version=1&stamp="+(new Date).getTime()+"&download_url="+encodeURIComponent(e.download_url)),setTimeout(function(){e.$router.push("/wpsshare/"+e.id)},512)})},computed:S()({},Object(D.d)(["preview_query","download_url","os","isWO"])),methods:S()({},Object(D.b)(["getMeta"]),{close:function(){this.adshow=!1,_dw.onEvent("share_preview_close")},open:function(){}})},Pe={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"preview"},[e.isWO?e._e():s("Vheader",{attrs:{fileid:e.id}}),e._v(" "),s("div",{class:["container",e.isWO?"web-office":""]},[s("Preview")],1),e._v(" "),s("transition",{attrs:{name:"slide-fade"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:e.adshow&&"ios"!==e.os,expression:"adshow && os !== 'ios'"}],staticClass:"subbox clearfix"},[s("div",{staticClass:"info clearfix"},[s("div",{staticClass:"logo"},[s("img",{attrs:{src:i("Vpqn"),alt:""}})]),e._v(" "),s("div",{staticClass:"wpsinfo"},[s("div",[s("p",{directives:[{name:"t",rawName:"v-t",value:"subInfo.clientName",expression:"'subInfo.clientName'"}],staticClass:"client-name",attrs:{nowrap:""}}),e._v(" "),s("p",{directives:[{name:"t",rawName:"v-t",value:"subInfo.adjust",expression:"'subInfo.adjust'"}],staticClass:"slogn"})])]),e._v(" "),s("span",{directives:[{name:"t",rawName:"v-t",value:"subInfo.open",expression:"'subInfo.open'"}],ref:"open",staticClass:"open GA_openClient",attrs:{size:"mini"}}),e._v(" "),s("div",{staticClass:"closebox GA_closeAd",on:{click:e.close}})])])])],1)},staticRenderFns:[]};var Re=i("VU/8")(Le,Pe,!1,function(e){i("4hwi")},"data-v-5e6d6225",null).exports,Ue={created:function(){J.a.done()},computed:S()({},Object(D.d)(["error"]))},We={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"errbox"},[i("div",{staticClass:"cerrorpage-container"},[i("div",{class:"errorpage-img "+(e.error?e.error:"errInter")}),e._v(" "),i("p",{staticClass:"errorpage-text"},[e._v(e._s(e.$m("p404."+e.error,"p404.errInter")))]),e._v(" "),i("a",{directives:[{name:"t",rawName:"v-t",value:"p404.back",expression:"'p404.back'"}],staticClass:"errorpage-url",attrs:{href:"/"}})])])},staticRenderFns:[]};var je=i("VU/8")(Ue,We,!1,function(e){i("UpOV")},"data-v-10be640d",null).exports,Fe={data:function(){return{src:""}},created:function(){J.a.done();var e=this.$route.params,t=e.id,i=e.nid;this.download_url?this.openWith():this.getMeta(t||i),this.destory()},computed:S()({},Object(D.d)(["download_url","os"]),{canOpen:function(){return!!this.download_url&&!!this.src}}),methods:S()({},Object(D.b)(["getMeta"]),Object(D.c)(["destory"]),{iframeLoad:function(){J.a.done()},openWith:function(){if("android"!==this.os){var e=this.os,t={MacOSX:"kingsoftofficeapp://qing?stamp="+(new Date).getTime()+"&download_url="+encodeURIComponent(this.download_url),windows:"ksoqing://type=open&stamp="+(new Date).getTime()+"&download_url="+encodeURIComponent(this.download_url),linux:"",ios:"",android:"kingsoftofficeapp://qing?version=1&stamp="+(new Date).getTime()+"&download_url="+encodeURIComponent(this.download_url),windowsPhone:""};this.src=t[e]}},jump:function(){var e=this.os;["","o","ms","moz","webkit"].forEach(function(e){var t=e+(e?"Hidden":"hidden");void 0!==document[t]&&(t,e+"visibilitychange")}),_dw.onEvent("share_middle_install");window.location.href={MacOSX:"https://www.wps.com?from=webshare",windows:"https://www.wps.com/download?from=webshare",linux:"https://wps-community.org",ios:"https://itunes.apple.com/us/app/wps-office-view-edit-word/id762263023?mt=8&uo=4",android:"https://play.google.com/store/apps/details?id=cn.wps.moffice_eng&referrer=utm_source%3Dcloudshare",windowsPhone:"https://www.wps.com?from=webshare"}[e]}}),watch:{download_url:function(e){e&&this.openWith()}}},Ne={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"openbox"},[i("div",{staticClass:"open-container"},[i("div",{staticClass:"logo-img"}),e._v(" "),i("p",{staticClass:"open-text"},[e._v(e._s(e.$t("subInfo.opening")))]),e._v(" "),i("p",[i("span",{directives:[{name:"t",rawName:"v-t",value:"subInfo.openErr",expression:"'subInfo.openErr'"}]}),e._v(" "),i("span",{directives:[{name:"t",rawName:"v-t",value:"subInfo.install",expression:"'subInfo.install'"}],staticClass:"open-url GA_jumpWeb",on:{click:e.jump}})])]),e._v(" "),e.canOpen?i("iframe",{staticClass:"view-frame",attrs:{src:e.src,frameborder:"0"},on:{load:e.iframeLoad}}):e._e()])},staticRenderFns:[]};var Ve=i("VU/8")(Fe,Ne,!1,function(e){i("C15t")},"data-v-76f49915",null).exports;b.default.use($e.a);var Ge,qe=new $e.a({mode:"history",routes:[{path:"/docs/:id",name:"old",component:Re,meta:{keepAlive:!0}},{path:"/d/:nid",name:"new",component:Re,meta:{keepAlive:!0}},{path:"/wpsshare/error",name:"",component:je},{path:"/wpsshare/:id",name:"",component:Ve},{path:"*",redirect:"/wpsshare/error"}]}),ze=i("TXmL"),He=i("urW8"),Xe=i.n(He),Be=i("bOdI"),Je=i.n(Be),Ye=(i("wUZ8"),Ge={p404:{notFound:"The page you requested cannot be found",tip:"You may enter the wrong address or the page has been removed",back:"Back to Home",DocNotExist:"The page you requested does not exist",LinkNotExist:"The link you requested does not exist",LinkExpired:"Link has expired",PermissionDenied:"Permission denied",canceled:"Sharing the link has been  successfully canceled",errInter:"Server Error"},header:{download:"Download file",cancelShare:"Cancel sharing",login:"Login",cancelView:" Are you sure you want to cancel sharing the link?",confirm:"Ok",cancel:"No",info:"Note"},preview:{download:"Download File",error:"Error",fileNotExists:"This file has been deleted.",downfail:"Several preview attemps have failed. Please download the file for viewing.",largefile:"Please download the file for viewing.",convertfail:"Several conversion attempts have failed .Please download the file for viewing.",unsupport:"Cannot preview. Please download the file for viewing.",unsupporttype:"This file format connot be previewed.",filetimeout:"File loading has timed out. Please try again later",notupload:"This file has failed to upload. Please check and try again.",invitecodeError:"Password is incorrect. Please try again.",permissionDenied:"No permission",converTimeout:"Conversion has timed out",checkSignatureFailed:"Signature Verification Failed",invalidParameter:"Invalid parameter",linkExpired:"Link has expired",previewFailed:"Failed to preview"},subInfo:{clientName:"WPS Office",adjust:"Free, Office and PDF",open:"Open",opening:"WPS Office will be opening",openErr:"If not opened properly",install:"Please install or update WPS Office"},Copylink:"Copied",Copyerror:"Copy failed",Anyone:"Anyone who got the link can visit",Anyedit:"Anyone who got the link can edit",Someone:"The specified user has access rights",Stopshare:"Stop Sharing",Thdays:"3 days",Sedays:"7 days",Thtdays:"30 days",Stoptip:"Other people will not be able to view or edit documents after they stop sharing",Off:"Document sharing is off",Start:"Open sharing",edit:"Edit",view:"View",Remove:"Remove",InivieTip:"Invite others to view/edit",Joined:"people joined",Selectedusers:"{num} selected users",Emptytip:"Please select the member you want to add",Success:"Success"},Je()(Ge,"Stopshare","Stop Sharing"),Je()(Ge,"Mycloud","My Cloud"),Ge);b.default.use(ze.a);var Ze=new ze.a({locale:"us",messages:{us:Ye},silentTranslationWarn:!0});Xe.a.i18n(function(e,t){return Ze.t(e,t)});var Ke=Ze,Qe=i("1f+G");b.default.config.productionTip=!1,b.default.use(C.a),b.default.use(g.a),b.default.use(f.a),b.default.use(h.a),b.default.use(u.a),b.default.use(d.a),b.default.use(c.a),b.default.use(Qe.a),b.default.prototype.$confirm=o.a.confirm,b.default.prototype.$message=a.a,b.default.prototype.$m=function(e,t){return Ke.te(e)?Ke.t(e):Ke.t(t)},new b.default({el:"#app",router:qe,i18n:Ke,store:z,components:{App:Oe},template:"<App/>"})},PXIr:function(e,t){},RWjY:function(e,t){},"U/ZW":function(e,t){},UpOV:function(e,t){},Vpqn:function(e,t,i){e.exports=i.p+"r/share/img/logo.25cd1ce.png"},"X+ky":function(e,t){},Yq4J:function(e,t){},cwe7:function(e,t){},infJ:function(e,t){},nLn8:function(e,t){},np2T:function(e,t){},oq7i:function(e,t){},tk6P:function(e,t){}},["NHnr"]);
//# sourceMappingURL=idx.8a36b.js.map