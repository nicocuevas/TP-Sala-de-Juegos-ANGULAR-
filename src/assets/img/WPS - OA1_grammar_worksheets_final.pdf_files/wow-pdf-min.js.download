var Mapping_Tag=new Object;Mapping_Tag.hasSmallFont="9",Mapping_Tag.css="237",Mapping_Tag.mDiagonalStyle="141",Mapping_Tag.linkEnd="97",Mapping_Tag.isRightToLeft="129",Mapping_Tag.topDrawingDatas="192",Mapping_Tag.linkStart="99",Mapping_Tag.pictureDatas="188",Mapping_Tag.path="47",Mapping_Tag.mSmallestFont="160",Mapping_Tag.convertFlowHandler="229",Mapping_Tag.verticalText="161",Mapping_Tag.acounting="105",Mapping_Tag.paraData="251",Mapping_Tag.ptgAddress="166",Mapping_Tag.height="35",Mapping_Tag.mLeftStyle="147",Mapping_Tag.shapeText="53",Mapping_Tag.filterData="67",Mapping_Tag.dUnderline="106",Mapping_Tag.cfDataBarValue="2",Mapping_Tag.iconSetType="18",Mapping_Tag.active="92",Mapping_Tag.mTopStyle="152",Mapping_Tag.mIsSubScript="116",Mapping_Tag.version="244",Mapping_Tag.headTop="196",Mapping_Tag.offsetRect="44",Mapping_Tag.left="39",Mapping_Tag.cssJson="238",Mapping_Tag.sheetTabColor="100",Mapping_Tag.mCharset="107",Mapping_Tag.iconIndex="17",Mapping_Tag.commentShape="27",Mapping_Tag.underLineClass="242",Mapping_Tag.hAlign="7",Mapping_Tag.mEndPos="108",Mapping_Tag.bg="205",Mapping_Tag.br="63",Mapping_Tag.gray="32",Mapping_Tag.startArrow="54",Mapping_Tag.cX="169",Mapping_Tag.cY="170",Mapping_Tag.hyperLinkType="165",Mapping_Tag.linkInfos="95",Mapping_Tag.foot="176",Mapping_Tag.cellDatas="91",Mapping_Tag.oriPath="46",Mapping_Tag.address="164",Mapping_Tag.colSpan="5",Mapping_Tag.styleManager="236",Mapping_Tag.mIsValid="137",Mapping_Tag.right="49",Mapping_Tag.mBackColor="134",Mapping_Tag.colDatas="78",Mapping_Tag.rowDataIndex="80",Mapping_Tag.wrapDrawingDatas="204",Mapping_Tag.x="61",Mapping_Tag.tl="74",Mapping_Tag.y="62",Mapping_Tag.drawingInfo="84",Mapping_Tag.sheetId="168",Mapping_Tag.isVerticalText="131",Mapping_Tag.opacity="45",Mapping_Tag.picWidth="209",Mapping_Tag.mBottomStyle="139",Mapping_Tag.spanData="252",Mapping_Tag.blackWhite="22",Mapping_Tag.slides="211",Mapping_Tag.dataDir="231",Mapping_Tag.compressJson="227",Mapping_Tag.mFirstSpan="104",Mapping_Tag.pathId="48",Mapping_Tag.lineEndCapStyle="41",Mapping_Tag.shadeDatas="189",Mapping_Tag.mIsBold="113",Mapping_Tag.wrapText="14",Mapping_Tag.middleDrawingDatas="187",Mapping_Tag.sUnderline="121",Mapping_Tag.mIsMergedCell="158",Mapping_Tag.defaultHeight="65",Mapping_Tag.degree="201",Mapping_Tag.isEnd="86",Mapping_Tag.hiddenRow="163",Mapping_Tag.cellInfos="220",Mapping_Tag.mFontSize="112",Mapping_Tag.imgPath="198",Mapping_Tag.name="94",Mapping_Tag.slideCount="212",Mapping_Tag.sheetDatas="0",Mapping_Tag.strokeWidth="57",Mapping_Tag.spanDatas="103",Mapping_Tag.configUrl="228",Mapping_Tag.color="19",Mapping_Tag.revDiagonalStyle="16",Mapping_Tag.textLines="191",Mapping_Tag.isFlipV="37",Mapping_Tag.isFlipH="36",Mapping_Tag.vertical="254",Mapping_Tag.title="1",Mapping_Tag.defaultWidth="66",Mapping_Tag.bottomDrawingDatas="179",Mapping_Tag.mergeC="42",Mapping_Tag.mInsideHorizStyle="143",Mapping_Tag.sameStyle="153",Mapping_Tag.cellTextDatas="221",Mapping_Tag.colNum="222",Mapping_Tag.endArrow="29",Mapping_Tag.mergeR="43",Mapping_Tag.rowSpan="11",Mapping_Tag.pageCount="71",Mapping_Tag.mDiagonalColor="140",Mapping_Tag.length="20",Mapping_Tag.hyperLinkDatas="68",Mapping_Tag.footLeft="193",Mapping_Tag.cssInfo="83",Mapping_Tag.brightness="24",Mapping_Tag.shapeId="52",Mapping_Tag.linkId="98",Mapping_Tag.cssDir="230",Mapping_Tag.pageIndex="79",Mapping_Tag.comment="26",Mapping_Tag.startY="172",Mapping_Tag.startX="171",Mapping_Tag.drawingPath="202",Mapping_Tag.colFilters="162",Mapping_Tag.slideId="217",Mapping_Tag.hValign="126",Mapping_Tag.mCellType="155",Mapping_Tag.mFontColor="109",Mapping_Tag.cellDecorations="219",Mapping_Tag.type="90",Mapping_Tag.vAlign="13",Mapping_Tag.marginRight="185",Mapping_Tag.levelInfo="87",Mapping_Tag.sheetIndex="82",Mapping_Tag.sheetTextColor="101",Mapping_Tag.headFoot="182",Mapping_Tag.mRowIdx="159",Mapping_Tag.sheetTabColorData="89",Mapping_Tag.hasBorder="8",Mapping_Tag.text="96",Mapping_Tag.mRightColor="149",Mapping_Tag.isRepeat="38",Mapping_Tag.isWrapText="132",Mapping_Tag.mInsideVertStyle="145",Mapping_Tag.mForceColor="136",Mapping_Tag.index="93",Mapping_Tag.mOtherSpans="123",Mapping_Tag.isShrinkToFit="130",Mapping_Tag.meredInfos="223",Mapping_Tag.slide="216",Mapping_Tag.displayNone="239",Mapping_Tag.contrast="28",Mapping_Tag.hasOffsetOnPictureFill="34",Mapping_Tag.style="12",Mapping_Tag.shapeTexts="190",Mapping_Tag.mColIdx="157",Mapping_Tag.pageInfos="174",Mapping_Tag.imagesDir="233",Mapping_Tag.sheetInfo="88",Mapping_Tag.mTopColor="151",Mapping_Tag.eachPagePicMap="232",Mapping_Tag.angledText="154",Mapping_Tag.className="4",Mapping_Tag.fillMode="206",Mapping_Tag.userRange="75",Mapping_Tag.mLeftColor="146",Mapping_Tag.mRevDiagonalStyle="148",Mapping_Tag.top="58",Mapping_Tag.rowDatas="81",Mapping_Tag.angle="125",Mapping_Tag.workDir="245",Mapping_Tag.mUnderline="120",Mapping_Tag.mIsItalic="114",Mapping_Tag.anchorCenter="250",Mapping_Tag.pieceMap="210",Mapping_Tag.cssAlignCss="200",Mapping_Tag.mStartPos="119",Mapping_Tag.lineDashing="40",Mapping_Tag.footTop="194",Mapping_Tag.mIsStrikeout="115",Mapping_Tag.isCenterCross="128",Mapping_Tag.defaultPageInfo="173",Mapping_Tag.width="60",Mapping_Tag.diagonalBorders="6",Mapping_Tag.pageImageList="226",Mapping_Tag.headLeft="195",Mapping_Tag.targetUrl="218",Mapping_Tag.marginTop="186",Mapping_Tag.mBottomColor="138",Mapping_Tag.emphasisClass="240",Mapping_Tag.diagonalStyle="15",Mapping_Tag.col="25",Mapping_Tag.num="225",Mapping_Tag.mFillStyle="135",Mapping_Tag.pic="207",Mapping_Tag.mCenterCrossWidth="156",Mapping_Tag.scaleX="247",Mapping_Tag.mRightStyle="150",Mapping_Tag.pieceCount="175",Mapping_Tag.scaleY="248",Mapping_Tag.pages="197",Mapping_Tag.tagFile="243",Mapping_Tag.isAlignFill="127",Mapping_Tag.rowNum="224",Mapping_Tag.hasBg="33",Mapping_Tag.links="215",Mapping_Tag.strokeColor="55",Mapping_Tag.strokeOpacity="56",Mapping_Tag.visible="59",Mapping_Tag.picHeight="208",Mapping_Tag.textAlign="253",Mapping_Tag.bottom="23",Mapping_Tag.mRawFontSize="118",Mapping_Tag.srcPath="249",Mapping_Tag.colWidths="64",Mapping_Tag.fill="30",Mapping_Tag.cellSpanData="102",Mapping_Tag.mIsRichText="122",Mapping_Tag.marginLeft="184",Mapping_Tag.background="214",Mapping_Tag.marginBottom="183",Mapping_Tag.resourceServerUrl="235",Mapping_Tag.colDataIndex="77",Mapping_Tag.mFontName="111",Mapping_Tag.indent="10",Mapping_Tag.borders="178",Mapping_Tag.bulletsInfo="246",Mapping_Tag.mIsSuperScript="117",Mapping_Tag.mSourceText="133",Mapping_Tag.mPara="124",Mapping_Tag.cfIconSetValue="3",Mapping_Tag.cellDataIndex="76",Mapping_Tag.head="177",Mapping_Tag.mFontFamily="110",Mapping_Tag.showGridLines="73",Mapping_Tag.slideSize="213",Mapping_Tag.fillType="31",Mapping_Tag.rot="50",Mapping_Tag.strikeThroughClass="241",Mapping_Tag.row="51",Mapping_Tag.mInsideVertColor="144",Mapping_Tag.infoFile="234",Mapping_Tag.backgroundShapeId="21",Mapping_Tag.comments="180",Mapping_Tag.gridInfo="85",Mapping_Tag.toolTip="167",Mapping_Tag.pageData="203",Mapping_Tag.rowHeights="72",Mapping_Tag.mergedDatas="70",Mapping_Tag.hyperLinkIndex="69",Mapping_Tag.alignLeft="199",Mapping_Tag.mInsideHorizColor="142",Mapping_Tag.hasParaBorder="181";
var Constants=function(){var _={INIT_PDF_NUM:5,LOAD_PDF_NUM:30},a={LOAD_PDF_SUCCESS:"load_pdf_success",LOAD_PDF_FAIL:"load_pdf_fail",START_LOAD_PDF:"start_load_pdf",END_LOAD_PDF:"end_load_pdf"},r={configUrl:"",isGenMobile:!0,enableWarterMark:!1,watermarkString:"金山wps",watermarkImg:"",isAbleCopy:!0,domain:"wps.cn"},e={RESOURCE_IMAGELIST:"pageImageList"};return{PDF:_,EVENT_NAME:a,CONFIG:r,CONST:e}}();
var EventHandler={handlerList:{},init:function(){EventHandler.handlerList=Events()},regeditListener:function(n,t){for(var r=0;r<t.length;r++)EventHandler.handlerList.listen(n,t[r])},dispatchEvent:function(n,t){EventHandler.handlerList.trigger(n,t)}};Events=function(){var n,t,r,e;return t={},e=this,n=function(n,r){var e,i;return e=null!=(i=t[n])?i:t[n]=[],e.push(r)},r=function(){var n,r,i,l,a,s;for(s=Array.prototype.shift.call(arguments),r=null!=(a=t[s])?a:t[s]=[],i=0,l=r.length;i<l;i++)if(n=r[i],n.apply(e,arguments)===!1)return!1},{listen:n,trigger:r}};
var ViewManager={mobileImgContainer:'<div class="mobileImgContainer" id="imgContainer_{{num}}" style="top: {{top}};height: {{height}};background-image:url({{url}});background-position: center;background-repeat: no-repeat; "></div>',tips:{container:'<div style="display: inline-block; height: inherit"><div class="tableCellContainer">部分内容未能加载，建议下载查看</div></div>',iconConainer:'<div style="display: inline-block" class="tipsIcon"><div class="tableCellContainer"><svg width="20px" height="20px" viewBox="0 0 12 12" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>Shape</title>    <desc>Created with Sketch.</desc>    <defs></defs>    <g id="Symbols" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">        <g id="waringIcon" transform="translate(-16.000000, -10.000000)" fill="#108EE9">            <g id="Shape">                <path d="M22,22 C18.6859375,22 16,19.3140625 16,16 C16,12.6859375 18.6859375,10 22,10 C25.3140625,10 28,12.6859375 28,16 C28,19.3140625 25.3140625,22 22,22 L22,22 Z M22,19.75 C22.2074219,19.75 22.375,19.5824219 22.375,19.375 C22.375,19.1675781 22.2074219,19 22,19 C21.7925781,19 21.625,19.1675781 21.625,19.375 C21.625,19.5824219 21.7925781,19.75 22,19.75 L22,19.75 Z M23.1191406,12.25 L22.3574219,12.25 L21.6074219,12.25 L20.8808594,12.25 C20.6734375,12.25 20.5058594,12.4175781 20.5058594,12.625 C20.5058594,12.8324219 20.6734375,13 20.8808594,13 L21.6074219,13 L21.6074219,16.7792969 L20.8691406,16.7792969 C20.6617187,16.7792969 20.4941406,16.946875 20.4941406,17.1542969 C20.4941406,17.3617188 20.6617187,17.5292969 20.8691406,17.5292969 L21.6074219,17.5292969 L21.9824219,17.5292969 C22.1898438,17.5292969 22.3574219,17.3617188 22.3574219,17.1542969 L22.3574219,13 L23.1191406,13 C23.3265625,13 23.5058594,12.8324219 23.5058594,12.625 C23.5058594,12.4175781 23.3265625,12.25 23.1191406,12.25 L23.1191406,12.25 Z" transform="translate(22.000000, 16.000000) scale(1, -1) translate(-22.000000, -16.000000) "></path>            </g>        </g>    </g></svg></div></div>',closeIconConainer:'<div id="closeIcon" style="display: inline-block" class="closeTipsIcon"><div class="tableCellContainer"><svg width="12px" height="12px" viewBox="0 0 8 8" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">    <title>Shape</title>    <desc>Created with Sketch.</desc>    <defs></defs>    <g id="Symbols" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" fill-opacity="0.43">        <g id="closeIcon" transform="translate(-504.000000, -12.000000)" fill="#000000">            <g id="Shape">                <path d="M511.897974,19.8979743 L511.897974,19.8979743 C511.763376,20.0325729 511.544788,20.0325729 511.410189,19.8979743 L508,16.4877852 L504.588734,19.8979743 C504.454136,20.0325729 504.235547,20.0325729 504.100949,19.8979743 L504.100949,19.8979743 C503.96635,19.7633757 503.96635,19.5447877 504.100949,19.4101891 L507.512215,16 L504.102026,12.5887341 C503.967427,12.4541355 503.967427,12.2355475 504.102026,12.1009489 L504.102026,12.1009489 C504.236624,11.9663504 504.455212,11.9663504 504.589811,12.1009489 L508,15.5122148 L511.411266,12.1020257 C511.545864,11.9674271 511.764453,11.9674271 511.899051,12.1020257 L511.899051,12.1020257 C512.03365,12.2366243 512.03365,12.4552123 511.899051,12.5898109 L508.487785,16 L511.897974,19.4112659 C512.032573,19.5458645 512.032573,19.7633757 511.897974,19.8979743 L511.897974,19.8979743 Z" transform="translate(508.000000, 15.999462) scale(1, -1) translate(-508.000000, -15.999462) "></path>            </g>        </g>    </g></svg></div></div>'}};
function binarySearch(e,n){var o=0,t=e.length-1;if(n<e[o])return o;if(n>e[t])return t;for(;o<=t;){var a=t+o>>1;if(n>e[a-1]&&n<e[a]||n==e[a]){if(n!=e[a]||e[a-1]!=e[a])return a;t=a-1}else n>e[a]?o=a+1:n<e[a]&&(t=a-1)}}function equalBinarySearch(e,n){for(var o=0,t=e.length-1;o<=t;){var a=parseInt((t+o)/2);if(n==e[a])return a;if(n>e[a])o=a+1;else{if(!(n<e[a]))return-1;t=a-1}}return-1}var WowCore={appShell:null,isInit:!1,resultInfoIsEnd:!1,resultInfo:null,resourceMap:new Object,loadingImgStart:-1,loadingImgEnd:-1,onCreate:function(e){WowCore.resourceMap[Constants.CONST.RESOURCE_IMAGELIST]=new Array,WowCore.updateResultInfo(!1),WowCore.appShell=e,WowCore.bindEvent(),WowCore.loadPdf(),WowCore.wowPdf=WowPdf,WowCore.wowPdf.onCreate()},bindEvent:function(){WowCore.appShell.eventHandlers.regeditListener(Constants.EVENT_NAME.LOAD_PDF_FAIL,[PdfEventHandler.loadPdfFail]),WowCore.appShell.eventHandlers.regeditListener(Constants.EVENT_NAME.START_LOAD_PDF,[PdfEventHandler.startLoadPdf]),WowCore.appShell.eventHandlers.regeditListener(Constants.EVENT_NAME.END_LOAD_PDF,[PdfEventHandler.endLoadPdf])},setPdfInfoScale:function(){var e=$(window).width();pdfInfo.scaleWidth=e,pdfInfo.scaleHeights=[],pdfInfo.pagesCaches=[];for(var n=0,o=0;o<pdfInfo.pdfCount;o++){var t=0,a=0,r=0;null==pdfInfo.pageInfos||void 0==pdfInfo.pageInfos?(t=pdfInfo.defaultWidth,a=pdfInfo.defaultHeight):0==o||void 0==pdfInfo.pageInfos[o+""]?(t=pdfInfo.defaultWidth,a=pdfInfo.defaultHeight):(t=pdfInfo.pageInfos[o+""][Mapping_Tag.width],a=pdfInfo.pageInfos[o+""][Mapping_Tag.height]),r=parseInt(pdfInfo.scaleWidth/t*a),pdfInfo.scaleHeights.push(r),n+=r,pdfInfo.pagesCaches.push(n)}pdfInfo.scrollHeight=n},loadPdf:function(){$.get("json/info.json",function(e){if(WowCore.updateResultInfoInterval(),WowCore.appShell.setTitle(e[Mapping_Tag.name]),pdfInfo.pdfCount=e[Mapping_Tag.num],pdfInfo.defaultWidth=e[Mapping_Tag.defaultPageInfo][Mapping_Tag.width],pdfInfo.defaultHeight=e[Mapping_Tag.defaultPageInfo][Mapping_Tag.height],pdfInfo.pageInfos=e[Mapping_Tag.pageInfos],BrowserInfo.versions.mobile){WowCore.setPdfInfoScale(),WowShell.pdfScroll.css({height:pdfInfo.scrollHeight+"px"}),WowUil.realScrollHeight=WowShell.mobileContainer[0].scrollHeight-WowShell.mobileContainer[0].clientHeight;var n=Constants.PDF.INIT_PDF_NUM;n>pdfInfo.pdfCount&&(n=pdfInfo.pdfCount),WowCore.loadingImgStart=0,WowCore.loadingImgEnd=n-1,WowCore.loadImage(n-1)}})},loadImage:function(e){if(!(void 0==e||e<0)&&e>=WowCore.loadingImgStart&&e<=WowCore.loadingImgEnd){var n=template.compile(ViewManager.mobileImgContainer);if(!WowCore.isInit){for(var o="",t=0;t<=e;t++)if(!($("#imgContainer_"+t).length>0)){var a=n({num:t,top:pdfInfo.getYByPage(t)+"px",height:pdfInfo.pageScaleHeight(t)+"px",url:commonResourceUrl+"loading-icon.gif"});o+=a}for(WowShell.mobileContainer.append(o),t=0;t<=e;t++)if(WowCore.checkResource(t+".png",Constants.CONST.RESOURCE_IMAGELIST)){var r=document.createElement("img");r.id="img_"+t,r.classList.add("pdfImg"),r.style.width=pdfInfo.scaleWidth+"px",r.setAttribute("index",t),r.onerror=function(){this.getAttribute("index")},r.onload=function(){var e=this.getAttribute("index");0==$("#img_"+e).length&&$("#imgContainer_"+e).append(this)},r.src="./page_images/"+t+".png"}return WowShell.uil.onCreate(WowShell),void(WowCore.isInit=!0)}if(!($("#img_"+e)>0)){if(0==$("#imgContainer_"+e).length){var i=$(n({num:e,top:pdfInfo.getYByPage(e)+"px",height:pdfInfo.pageScaleHeight(e)+"px",url:commonResourceUrl+"loading-icon.gif"}));WowShell.mobileContainer.append(i)}if(WowCore.checkResource(e+".png",Constants.CONST.RESOURCE_IMAGELIST)){var r=document.createElement("img");r.id="img_"+e,r.classList.add("pdfImg"),r.style.width=pdfInfo.scaleWidth+"px",r.setAttribute("index",e),r.onerror=function(){this.getAttribute("index")},r.onload=function(){var e=this.getAttribute("index");0==$("#img_"+e).length&&$("#imgContainer_"+e).append(this)},r.src="./page_images/"+e+".png"}}}},updateResultInfoInterval:function(){var e=0,n=setInterval(function(){WowCore.updateResultInfo(!0),e++,(WowCore.resultInfoIsEnd||e>30)&&(clearInterval(n),!WowCore.resultInfoIsEnd&&e>30&&$.ajax({type:"GET",url:"result.txt",contentType:"application/octet-stream",success:function(e){2==e&&WowCore.showUndoneTips()}}))},2e3)},updateResultInfo:function(e){WowCore.resultInfoIsEnd||$.ajax({type:"GET",url:"json/result_info.json",async:e,success:function(e){WowCore.handlerResultInfo(e),WowCore.resultInfoIsEnd&&$.ajax({type:"GET",url:"result.txt",contentType:"application/octet-stream",success:function(e){2==e&&WowCore.showUndoneTips()}})}})},showUndoneTips:function(){if(0===$("#extractUndoneTip").children().length){var e=document.createDocumentFragment(),n=$(ViewManager.tips.iconConainer)[0],o=$(ViewManager.tips.container)[0],t=$(ViewManager.tips.closeIconConainer)[0];e.appendChild(n),e.appendChild(o),e.appendChild(t),WowShell.extractUndoneTip[0].appendChild(e);var a=$("div#closeIcon");a.on("click",function(){WowShell.extractUndoneTip.css({display:"none"})}),WowShell.extractUndoneTip.css({display:"inline-block"})}else WowShell.extractUndoneTip.css({display:"inline-block"})},handlerResultInfo:function(e){WowCore.resultInfoIsEnd=e[Mapping_Tag.isEnd],WowCore.resultInfo=e,WowCore.resultInfo[Mapping_Tag[Constants.CONST.RESOURCE_IMAGELIST]].sort(),console.log(WowCore.resultInfo);for(var n=WowCore.resourceMap[Constants.CONST.RESOURCE_IMAGELIST],o=n.length-1;o>=0;o--){var t=n[o];if(equalBinarySearch(WowCore.resultInfo[Mapping_Tag[Constants.CONST.RESOURCE_IMAGELIST]],t)!=-1){var a=parseInt(t);WowCore.loadImage(a),WowCore.resourceMap[Constants.CONST.RESOURCE_IMAGELIST].splice(o,1)}}},checkResource:function(e,n){return null!=WowCore.resultInfo&&(equalBinarySearch(WowCore.resultInfo[Mapping_Tag[n]],e)!=-1||(WowCore.resourceMap[n].sort(),equalBinarySearch(WowCore.resourceMap[n],e)==-1&&WowCore.resourceMap[n].push(e),!1))}},PdfEventHandler={startLoadPdf:function(){},endLoadPdf:function(e){},loadPdfFail:function(e){}},pdfInfo={pdfCount:null,defaultWidth:null,defaultHeight:null,scaleWidth:null,scaleHeights:[],pagesCaches:[],pageInfos:null,scrollHeight:null,pageScaleHeight:function(e){return pdfInfo.scaleHeights[e]},getYByPage:function(e){return e<=0?0:pdfInfo.pagesCaches[e-1]},getPageByY:function(e){return binarySearch(pdfInfo.pagesCaches,e)}};
var WowPdf={onCreate:function(){},updateViewPort:function(n){var t=pdfInfo.getPageByY(n.top),o=pdfInfo.getPageByY(n.bottom);t<0&&(t=0),o>pdfInfo.pdfCount-1&&(o=pdfInfo.pdfCount-1),WowCore.loadingImgStart=t,WowCore.loadingImgEnd=o;for(var r=[],e=[],a=t;a<=o;a++)r.push(a);var f=[];if($(".pdfImg").each(function(){var n=$(this),t=parseInt(n.attr("id").substring(4));f.push(t)}),e=ArrayMinus(r,f),e.sort(function(n,t){return n-t}),e.length+f.length>Constants.PDF.LOAD_PDF_NUM){var i=e.length+f.length-Constants.PDF.LOAD_PDF_NUM,g=ArrayMinus(f,r);g.sort(function(n,t){return n-t});var h=[],s=r.length;if(WowUil.direction){for(a=0;a<g.length&&!(g[a]>=r[0])&&(h.push(g[a]),h.length!=i);a++);if(h.length!=i)for(var u=g.length-1;u>=a&&!(g[u]<=r[s-1])&&(h.push(g[u]),h.length!=i);u--);}else{for(a=g.length-1;a>=0&&!(g[a]<=r[s-1])&&(h.push(g[a]),h.length!=i);a--);if(h.length!=i)for(var u=0;u<=a&&!(g[u]>=r[0])&&(h.push(g[u]),h.length!=i);u++);}h.forEach(function(n){$("#imgContainer_"+n).remove()})}e.forEach(function(n){WowCore.loadImage(n)});var l=[];$(".mobileImgContainer:not(:has(.pdfImg))").each(function(){var n=$(this),r=parseInt(n.attr("id").substring(13));(r<t||r>o)&&l.push(r)}),l.forEach(function(n){$("#imgContainer_"+n).remove()})}};
var WowShell={appCore:null,uil:null,eventHandlers:{},pcContainer:$("#outerContainer"),mobileContainer:$("#mobileContainer"),pdfScroll:$("#pdfScroll"),pageNumTimer:null,mobilePageTips:$("#mobilePageTips"),pageNumContainer:$("#pageNumContainer"),mobileSlider:$("#mobileSlider"),sliderTimer:null,coverScrollerBar:$("#coverScrollerBar"),extractUndoneTip:$("#extractUndoneTip"),onCreate:function(){WowShell.initContainerCss&&WowShell.initContainerCss(),WowUil.sliderScrollHeight=$(window).height()-36,WowShell.eventHandlers=EventHandler,WowShell.eventHandlers.init(),WowShell.appCore=WowCore,WowShell.uil=WowUil,WowShell.appCore.onCreate(WowShell)},setTitle:function(e){document.title=e},initContainerCss:function(){BrowserInfo.versions.mobile?(WowShell.mobileContainer.css({display:"block",height:$(window).height()+"px"}),BrowserInfo.versions.ios&&(WowShell.mobileContainer.css({overflowX:"hidden",paddingRight:"10px"}),$(document.body).css({overflowX:"hidden"}))):WowShell.pcContainer.css({display:"block"})},onResize:function(){if(BrowserInfo.versions.mobile){var e=$(window).height();WowShell.mobileContainer.css({height:e+"px"}),WowCore.setPdfInfoScale(),WowShell.pdfScroll.css({height:pdfInfo.scrollHeight+"px"});var o=$(".mobileImgContainer");o.each(function(){var e=$(this),o=parseInt(e.attr("id").substring(13)),l=pdfInfo.pageScaleHeight(o),i=pdfInfo.getYByPage(o);e.css({top:i+"px",height:l+"px"}),e.children("img").css({width:pdfInfo.scaleWidth+"px"})}),WowUil.sliderScrollHeight=e-36,WowUil.realScrollHeight=WowShell.mobileContainer[0].scrollHeight-WowShell.mobileContainer[0].clientHeight;var l=WowUil.currPageNum,i=pdfInfo.getYByPage(l-1);i<0&&(i=0),i>WowUil.realScrollHeight&&(i=WowUil.realScrollHeight),WowShell.mobileContainer.scrollTop(i)}},showPageNum:function(e,o){WowShell.mobilePageTips.css({opacity:1});var l=0;l=0==e?1:e==WowUil.realScrollHeight?pdfInfo.pdfCount:pdfInfo.getPageByY(e+o/2)+1,l<1&&(l=1),l>pdfInfo.pdfCount&&(l=pdfInfo.pdfCount),WowUil.currPageNum=l,WowShell.pageNumContainer.text(l+"/"+pdfInfo.pdfCount),clearTimeout(WowShell.pageNumTimer),WowShell.pageNumTimer=setTimeout(function(){WowUil.slideFn.getIsDrag()||WowShell.mobilePageTips.css({opacity:0})},2e3)}};$(document).ready(function(){setTimeout(function(){try{document.domain=Constants.CONFIG.domain}catch(e){}return BrowserInfo.versions.mobile?void WowShell.onCreate():($("#outerContainer").show(),void WowShell.webViewerLoadPDFJS())},0)});
var WowUil={appShell:null,appCore:null,lastTop:0,direction:!0,slideFn:null,sliderScrollHeight:0,realScrollHeight:0,currPageNum:1,onCreate:function(o){if(WowUil.appShell=o,WowUil.appCore=WowUil.appShell.appCore,BrowserInfo.versions.mobile){WowShell.mobileContainer.scroll(function(){WowUil.scrollY()});var l=WowUil.debounce(function(){WowShell.onResize()},100);$(window).on("resize ",l),WowUil.slideFn=WowUil.bindSliderEvent(WowShell.mobileSlider)}},scrollY:function(){var o=WowShell.mobileContainer.scrollTop();WowUil.direction=WowUil.lastTop-o<0,WowUil.lastTop=o;var l=WowShell.mobileContainer.height();WowShell.showPageNum(o,l);var e=o/WowUil.realScrollHeight,i=e*WowUil.sliderScrollHeight;WowUil.slideFn.showSlider(),WowShell.mobileSlider.css({top:i+"px"});var n=o,t=o+l;WowUil.direction?(n=o-.5*l,t=o+2*l):(n=o-l,t=o+1.5*l),n<0?n=0:n,t>WowShell.mobileContainer[0].scrollHeight?t=WowShell.mobileContainer[0].scrollHeight:t,WowPdf.updateViewPort({top:n,bottom:t})},debounce:function(o,l,e){var i;return function(){var n=this,t=arguments,r=function(){i=null,e||o.apply(n,t)},c=e&&!i;clearTimeout(i),i=setTimeout(r,l),c&&o.apply(n,t)}},bindSliderEvent:function(o){var l=!1,e=0,i=function(o){return r(),l=!0,e=o.originalEvent.targetTouches[0].clientY,!1},n=function(i){if(r(),l){var n=i.originalEvent.targetTouches[0].clientY,t=o.position().top,c=n-e,a=t+c;a<0&&(a=0),a>$(window).height()-36&&(a=$(window).height()-36),o.css({top:a+"px"});var h=a/WowUil.sliderScrollHeight,w=h*WowUil.realScrollHeight,s=WowShell.mobileContainer.height();WowShell.showPageNum(w,s),e=n}return!1},t=function(i){if(l){var n=i.originalEvent.changedTouches[0].clientY,t=o.position().top,r=n-e,c=t+r;c<0&&(c=0),c>$(window).height()-36&&(c=$(window).height()-36),o.css({top:c+"px"});var a=c/WowUil.sliderScrollHeight,h=a*WowUil.realScrollHeight;WowShell.mobileContainer.scrollTop(h)}l=!1},r=function(){o.css({opacity:1}),clearTimeout(WowShell.sliderTimer),WowShell.sliderTimer=setTimeout(function(){l||a()},2e3)},c=function(){return l},a=function(){o.css({opacity:0})};return o.on("touchstart",i),o.on("touchmove",n),o.on("touchend",t),{showSlider:r,hideSlider:a,getIsDrag:c}}};
function WowMap(){function e(e){for(var t=0;t<f.length;t++)if(f[t].key==e)return!0;return!1}function t(e){for(var t=0;t<f.length;t++)if(f[t].key==e)return t;return-1}function n(e){f.splice(e,1)}function o(e,o){var r=t(e);r!=-1&&n(r),f.push({key:e,value:o})}function r(e){for(var t=0;t<f.length;t++)if(f[t].key==e)return f[t].value}function i(){return f}function a(){f.splice(0,f.length)}function l(){return f.length}var f=new Array,c={put:o,get:r,getAll:i,remove:n,indexOf:t,contain:e,clear:a,size:l};return c}function swapNodes(e,t){var n=e.parentNode,o=e.nextSibling===t?e:e.nextSibling;t.parentNode.insertBefore(e,t),n.insertBefore(t,o)}function WebDb(){}function ArrayMinus(e,t){for(var n=new Array,o={},r=0;r<t.length;r++)o[t[r]]=1;for(var i=0;i<e.length;i++)o[e[i]]||(o[e[i]]=1,n.push(e[i]));return n}!function(){Function.prototype.bind||(Function.prototype.bind=function(e){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var t=Array.prototype.slice.call(arguments,1),n=this,o=function(){},r=function(){return r.prototype=this instanceof o?new o:r.prototype,n.apply(this instanceof o?this:e||this,t.concat(Array.prototype.slice.call(arguments)))};return this.prototype&&(o.prototype=this.prototype),r})}();var BrowserInfo={versions:function(){var e=navigator.userAgent;navigator.appVersion;return{trident:e.indexOf("Trident")>-1,presto:e.indexOf("Presto")>-1,webKit:e.indexOf("AppleWebKit")>-1,gecko:e.indexOf("Gecko")>-1&&e.indexOf("KHTML")==-1,mobile:!!e.match(/AppleWebKit.*Mobile.*/)||!!e.match(/Android/),ios:!!e.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:e.indexOf("Android")>-1||e.indexOf("Linux")>-1,iPhone:e.indexOf("iPhone")>-1,iPad:e.indexOf("iPad")>-1,webApp:e.indexOf("Safari")==-1}}(),language:(navigator.browserLanguage||navigator.language).toLowerCase()},HtmlUtil={replaceHtml:function(e,t){e.innerHTML?e.innerHTML+=t:e.innerHTML=t}};WebDb.sessionPut=function(e,t){if(void 0!=typeof sessionStorage){var n=JSON.stringify(t);try{sessionStorage.setItem(e,n)}catch(o){sessionStorage.clear(),sessionStorage.setItem(e,n)}}},WebDb.sessionGet=function(e){if(void 0==typeof sessionStorage)return null;try{var t=JSON.parse(sessionStorage[e]);return t}catch(n){return null}},WebDb.sessionClear=function(){void 0!=typeof sessionStorage&&sessionStorage.clear()},WebDb.localPut=function(e,t){if(void 0!=typeof localStorage){var n=JSON.stringify(t);localStorage[e]=n}},WebDb.localGet=function(e){if(void 0==typeof localStorage)return null;try{var t=JSON.parse(localStorage[e]);return t}catch(n){return null}},WebDb.localLength=function(e){var t=0;if(void 0!=typeof localStorage)for(var n=localStorage.length,o=0;o<n;o++){var r=localStorage.key(o);void 0!=e?0==r.indexOf(e)&&t++:r.indexOf("SlideBorder")!=-1&&t++}return t},WebDb.localAllKeyByPPTKey=function(e){var t=[];if(void 0!=typeof localStorage)for(var n=localStorage.length,o=0;o<n;o++){var r=localStorage.key(o);0==r.indexOf(e)&&t.push(r)}return t},WebDb.clearOtherAllLocalByPPTKey=function(e,t){if(void 0!=typeof localStorage)for(var n=0,o=localStorage.length,r=0;r<o;r++){var i=localStorage.key(r);if(0!=i.indexOf(e)&&i.indexOf("SlideBorder")!=-1&&(n++,localStorage.removeItem(i),o=localStorage.length,r--,n==t))return}};